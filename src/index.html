<!-- public/index.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>自适应必应壁纸</title>
  <style>
    :root {
      --pc-bg: url('');
      --pad-bg: url('');
      --mobile-bg: url('');
    }

    body {
      margin: 0;
      height: 100vh;
      background-size: cover;
      background-position: center;
      transition: background-image 0.5s;
    }

    /* 响应式媒体查询 */
    @media (min-width: 1024px) { 
      body { background-image: var(--pc-bg); }
    }
    @media (min-width: 768px) and (max-width: 1023px) {
      body { background-image: var(--pad-bg); }
    }
    @media (max-width: 767px) {
      body { background-image: var(--mobile-bg); }
    }
  </style>
</head>
<body>
  <div class="copyright" style="position: fixed; bottom: 10px; right: 10px; color: white;"></div>

  <script>
    async function loadWallpaper() {
      try {
        const response = await fetch('/.netlify/functions/bing-proxy');
        const data = await response.json();
        
        // 动态设置CSS变量
        document.documentElement.style.setProperty('--pc-bg', `url('${data.pc}')`);
        document.documentElement.style.setProperty('--pad-bg', `url('${data.pad}')`);
        document.documentElement.style.setProperty('--mobile-bg', `url('${data.mobile}')`);

        // 显示版权信息
        document.querySelector('.copyright').textContent = data.copyright;

        // 添加窗口大小监听
        window.addEventListener('resize', () => {
          document.body.style.backgroundImage = getComputedStyle(document.documentElement)
            .getPropertyValue(`--${getDeviceType()}-bg`);
        });
      } catch (error) {
        console.error('壁纸加载失败:', error);
        document.body.style.background = '#1a1a1a';
      }
    }

    // 设备类型检测
    function getDeviceType() {
      const width = window.innerWidth;
      if (width >= 1024) return 'pc';
      if (width >= 768) return 'pad';
      return 'mobile';
    }

    // 初始化加载
    window.addEventListener('load', loadWallpaper);
  </script>
</body>
</html>
